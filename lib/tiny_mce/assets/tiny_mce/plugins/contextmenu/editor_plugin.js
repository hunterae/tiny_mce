(function(){var g=tinymce.dom.Event,h=tinymce.DOM;tinymce.create("tinymce.plugins.ContextMenu",{init:function(b){function a(e,f){d=null;if(f&&f.button==2)d=e.selection.getRng();else if(c._menu){c._menu.removeAll();c._menu.destroy();g.remove(e.getDoc(),"click",a)}}var c=this,d;c.editor=b;c.onContextMenu=new tinymce.util.Dispatcher(this);b.onContextMenu.add(function(e,f){if(!f.ctrlKey){d&&e.selection.setRng(d);c._getMenu(e).showMenu(f.clientX,f.clientY);g.add(e.getDoc(),"click",function(i){a(e,i)});
g.cancel(f)}});b.onRemove.add(function(){c._menu&&c._menu.removeAll()});b.onMouseDown.add(a);b.onKeyDown.add(a)},getInfo:function(){return{longname:"Contextmenu",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/contextmenu",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_getMenu:function(b){var a=this._menu,c=b.selection,d=c.isCollapsed();c=c.getNode()||b.getBody();if(a){a.removeAll();a.destroy()}a=h.getPos(b.getContentAreaContainer());
h.getPos(b.getContainer());this._menu=a=b.controlManager.createDropMenu("contextmenu",{offset_x:a.x+b.getParam("contextmenu_offset_x",0),offset_y:a.y+b.getParam("contextmenu_offset_y",0),constrain:1});a.add({title:"advanced.cut_desc",icon:"cut",cmd:"Cut"}).setDisabled(d);a.add({title:"advanced.copy_desc",icon:"copy",cmd:"Copy"}).setDisabled(d);a.add({title:"advanced.paste_desc",icon:"paste",cmd:"Paste"});if(c.nodeName=="A"&&!b.dom.getAttrib(c,"name")||!d){a.addSeparator();a.add({title:"advanced.link_desc",
icon:"link",cmd:b.plugins.advlink?"mceAdvLink":"mceLink",ui:true});a.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"})}a.addSeparator();a.add({title:"advanced.image_desc",icon:"image",cmd:b.plugins.advimage?"mceAdvImage":"mceImage",ui:true});a.addSeparator();b=a.addMenu({title:"contextmenu.align"});b.add({title:"contextmenu.left",icon:"justifyleft",cmd:"JustifyLeft"});b.add({title:"contextmenu.center",icon:"justifycenter",cmd:"JustifyCenter"});b.add({title:"contextmenu.right",icon:"justifyright",
cmd:"JustifyRight"});b.add({title:"contextmenu.full",icon:"justifyfull",cmd:"JustifyFull"});this.onContextMenu.dispatch(this,a,c,d);return a}});tinymce.PluginManager.add("contextmenu",tinymce.plugins.ContextMenu)})();
